{% extends 'project/index.html' %}

{% load utiltags %}
{% load humanize %}
{% block menu %}
    <ul id="menu" value ="/project/rebudget/"></ul>
{% endblock %}
{% block style %}
.style1 {
	color: #CC9900;
	font-size: 24px;
}
.style2 {
	color: #FF0000;
}
td.even2 {
  background-color: #FFFF99;
}

td.odd2 {
  background-color: #FFFF66;
}
td.even3 {
  background-color: #A5F0B4;
}

td.odd3 {
  background-color: #A5F078;
}

.showTable{
    color: grey;
}
.hideTable{
    color: blue;
}
.setDisplay{
    color: black;
    font-weight: bold;
}
.SumBar{
    color: black;
}

.fixLeftTop{
    POSITION: relative;
    Left: expression(this.offsetParent.scrollLeft-1);
    TOP: expression(this.offsetParent.scrollTop-1);
    z-index:103 ;
}
.fixTop{
    POSITION: relative;
    TOP: expression(this.offsetParent.scrollTop-1);
    z-index:102 ;
}
.fixLeft{
    POSITION: relative;
    Left: expression(this.offsetParent.scrollLeft-1);
    z-index:101;
}
td {padding:2px 5px;}
th {padding:2px 5px;}
{% endblock %}
{% block content %}
<br>
<span style="font-size: 16px;">
<!-- 搜尋區 -->
<form action="./" method="POST">
    <table align="center">
        <tr align="center">
        {% for field in form %}
            <th>{{ field.label_tag }}</th>
        {% endfor %}
            <th>漁港</th>
        </tr>
        <tr align="center">
        {% for field in form %}
            <td>{{ field }}</td>
        {% endfor %}
            <th id="FishingPort">
                <select id="port" name="port">
                    <option value="">請選擇縣市</option>
                    {% for port in port_list %}
                    <option value="{{ port.id }}" {% ifequal port.id select_port %}selected{% endifequal %}>{{ port.name }}</option>
                    {% endfor %}
                </select>
            </th>
        </tr>
    </table>
    搜尋結果依照
    <select name="sortBy" id="id_sortBy">
        <option value="year" {% ifequal sortBy 'year' %}selected="selected"{% endifequal %}>年度</option>
        <option value="place" {% ifequal sortBy 'place' %}selected="selected"{% endifequal %}>縣市</option>
        <option value="name" {% ifequal sortBy 'name' %}selected="selected"{% endifequal %}>工作名稱</option>
        <option value="project_sub_type" {% ifequal sortBy 'project_sub_type' %}selected="selected"{% endifequal %}>工程屬性別</option>
        <option value="undertake_type" {% ifequal sortBy 'undertake_type' %}selected="selected"{% endifequal %}>承辦方式</option>
        <option value="budget_type" {% ifequal sortBy 'budget_type' %}selected="selected"{% endifequal %}>預算別</option>
        <option value="plan" {% ifequal sortBy 'plan' %}selected="selected"{% endifequal %}>計畫名稱</option>
        <option value="unit" {% ifequal sortBy 'unit' %}selected="selected"{% endifequal %}>執行機關</option>
        <option value="status" {% ifequal sortBy 'status' %}selected="selected"{% endifequal %}>工程狀態</option>
    </select>
    排序<br>

    <input type="submit" name="submit" value="開始搜尋" style="width:100px;height:50px;" onClick="loading(this)">
    <a href="/project/rebudget/advanced/">進階搜尋</a>
    <br><input type="button" name="clearBudgetInfo" id="clearBudgetInfo" value="清空資訊重新查詢" onClick="loading(this)">
</form>

    {% pyif projects_num == 0 %}
        無資料，請重設搜尋條件
    {% endif %}

    {% pyif projects_num > 0 %}
        <br>
        <table border="1" style="border-collapse: collapse">
            <thead align="center">
                <tr>
                    <td colspan="7" width="900">
                        <a id="showSum" class="SumBar" margin="200">< 顯示預算加總表 ></a>
                        <a id="hideSum" class="SumBar" margin="200" style="display:none;">< 隱藏預算加總表 ></a>
                    </td>
                </tr>
            </thead>
            <tbody align="right" id="SumTable" style="display:none;">
            <tr align="center">
                <td></td>
                <td width="150" bgcolor="#F0F078">資本門</td>
                <td width="150" bgcolor="#F0F078">資本門總預算</td>
                <td width="150" bgcolor="#F0F078">資本門剩餘預算</td>
                <td width="150" bgcolor="#B4E1B4">經常門</td>
                <td width="150" bgcolor="#B4E1B4">經常門總預算</td>
                <td width="150" bgcolor="#B4E1B4">經常門剩餘預算</td>
                <!--<td width="150">總計</td>-->
            </tr>
            <tr>
                <td align="left">自辦總預算額</td>
                <td id="now_self_c" nv="{{ sum_list.self.capital }}" bgcolor="#F0F0B4">{{ sum_list.self.capital|intcomma|cutzero }}</td>
                <td bgcolor="#F0F0B4"><input id="self_limit" bt="self_c" class="balance" size="10"></td>
                <td bgcolor="#F0F0B4"><span id="ans_self_c"></span></td>
                <td id="now_self_r" nv="{{ sum_list.self.regular }}" bgcolor="#B4F0B4">{{ sum_list.self.regular|intcomma|cutzero }}</td>
                <td bgcolor="#B4F0B4"><input id="self_limit" bt="self_r" class="balance" size="10"></td>
                <td bgcolor="#B4F0B4"><span id="ans_self_r"></span></td>
                <!--<td id="now_self" nv="{{ sum_list.self.total }}">{{ sum_list.self.total|intcomma|cutzero }}</td>-->
            </tr>
            <tr>
                <td align="left">委辦總預算額</td>
                <td id="now_commission_c" nv="{{ sum_list.commission.capital }}" bgcolor="#F0F0B4">{{ sum_list.commission.capital|intcomma|cutzero }}</td>
                <td bgcolor="#F0F0B4"><input id="commission_limit" bt="commission_c" class="balance" size="10"></td>
                <td bgcolor="#F0F0B4"><span id="ans_commission_c"></span></td>
                <td id="now_commission_r" nv="{{ sum_list.commission.regular }}" bgcolor="#B4F0B4">{{ sum_list.commission.regular|intcomma|cutzero }}</td>
                <td bgcolor="#B4F0B4"><input id="commission_limit" bt="commission_r" class="balance" size="10"></td>
                <td bgcolor="#B4F0B4"><span id="ans_commission_r"></span></td>
                <!--<td id="now_commission" nv="{{ sum_list.commission.total }}">{{ sum_list.commission.total|intcomma|cutzero }}</td>-->
            </tr>
            <tr>
                <td align="left">補助總預算額</td>
                <td id="now_grant_c" nv="{{ sum_list.grant.capital }}" bgcolor="#F0F0B4">{{ sum_list.grant.capital|intcomma|cutzero }}</td>
                <td bgcolor="#F0F0B4"><input id="grant_limit" bt="grant_c" class="balance" size="10"></td>
                <td bgcolor="#F0F0B4"><span id="ans_grant_c"></span></td>
                <td id="now_grant_r" nv="{{ sum_list.grant.regular }}" bgcolor="#B4F0B4">{{ sum_list.grant.regular|intcomma|cutzero }}</td>
                <td bgcolor="#B4F0B4"><input id="grant_limit" bt="grant_r" class="balance" size="10"></td>
                <td bgcolor="#B4F0B4"><span id="ans_grant_r"></span></td>
                <!--<td id="now_grant" nv="{{ sum_list.grant.total }}">{{ sum_list.grant.total|intcomma|cutzero }}</td>-->
            </tr>
            </tbody>
        </table>
        <br><br><br>


        <table width="1000">
            <tr>
                <td></td>
                <td width="100"><a id="Hide" class="transAll setDisplay">全部隱藏</a></td>
                <td width="100"><a id="Show" class="transAll setDisplay">全部顯示</a></td>
                <td width="100" align="right">
                    <div id="ShowPoppingMemu" align="right" class="show_hided_table setDisplay">顯示設定</div>
                </td>
                <td width="50" align="left">
                    <a id="down" class="FixPoppingMemu setDisplay">▼</a><a id="up" class="FixPoppingMemu setDisplay" style="display:none;">▲</a>
                </td>
                <td width="160">
                    <div align="right">共 {{ projects_num }} 個結果</div>
                </td>
            </tr>
        </table>
</span>




<span style="font-size: 14px;">
<table id="PoppingMemu" class="show_hided_table" style="display:none;">
    <tbody align="left">
    <tr>
        <td width="30" align="center" valign="center">
            <img id="showed_year" class="showed_img" src="/media/project/image/open.png" width="20">
            <img id="hidedn_year" class="hidedn_img" src="/media/project/image/close.png" width="20" style="display:none;">
        </td>
        <td>
            <a id="hide_year" class="hideTable" tar="year">預算年度</a>
            <a id="show_year" class="showTable" tar="year" style="display:none;">年度</a>
        </td>
        <td width="30"></td>
    </tr>
    <tr>
        <td width="30" align="center" valign="center">
            <img id="showed_place" class="showed_img" src="/media/project/image/open.png" width="20">
            <img id="hidedn_place" class="hidedn_img" src="/media/project/image/close.png" width="20" style="display:none;">
        </td>
        <td>
            <a id="hide_place" class="hideTable" tar="place">縣市</a>
            <a id="show_place" class="showTable" tar="place" style="display:none;">縣市</a>
        </td>
        <td></td>
    </tr>
    <tr>
        <td width="30" align="center" valign="center">
            <img id="showed_port" class="showed_img" src="/media/project/image/open.png" width="20">
            <img id="hidedn_port" class="hidedn_img" src="/media/project/image/close.png" width="20" style="display:none;">
        </td>
        <td>
            <a id="hide_port" class="hideTable" tar="port">漁港/養殖區</a>
            <a id="show_port" class="showTable" tar="port" style="display:none;">漁港/養殖區</a>
        </td>
        <td></td>
    </tr>
    <tr>
        <td width="30" align="center" valign="center">
            <img id="showed_plan_no" class="showed_img" src="/media/project/image/open.png" width="20">
            <img id="hidedn_plan_no" class="hidedn_img" src="/media/project/image/close.png" width="20" style="display:none;">
        </td>
        <td>
            <a id="hide_plan_no" class="hideTable" tar="plan_no">計畫編號</a>
            <a id="show_plan_no" class="showTable" tar="plan_no" style="display:none;">計畫編號</a>
        </td>
        <td></td>
    </tr>
    <tr>
        <td width="30" align="center" valign="center">
            <img id="showed_project_sub_type" class="showed_img" src="/media/project/image/open.png" width="20">
            <img id="hidedn_project_sub_type" class="hidedn_img" src="/media/project/image/close.png" width="20" style="display:none;">
        </td>
        <td>
            <a id="hide_project_sub_type" class="hideTable" tar="project_sub_type">工程屬性別</a>
            <a id="show_project_sub_type" class="showTable" tar="project_sub_type" style="display:none;">工程屬性別</a>
        </td>
        <td></td>
    </tr>
    <tr>
        <td width="30" align="center" valign="center">
            <img id="showed_undertake_type" class="showed_img" src="/media/project/image/open.png" width="20">
            <img id="hidedn_undertake_type" class="hidedn_img" src="/media/project/image/close.png" width="20" style="display:none;">
        </td>
        <td>
            <a id="hide_undertake_type" class="hideTable" tar="undertake_type">承辦方式</a>
            <a id="show_undertake_type" class="showTable" tar="undertake_type" style="display:none;">承辦方式</a>
        </td>
        <td></td>
    </tr>
    <tr>
        <td width="30" align="center" valign="center">
            <img id="showed_budget_type" class="showed_img" src="/media/project/image/open.png" width="20">
            <img id="hidedn_budget_type" class="hidedn_img" src="/media/project/image/close.png" width="20" style="display:none;">
        </td>
        <td>
            <a id="hide_budget_type" class="hideTable" tar="budget_type">預算別</a>
            <a id="show_budget_type" class="showTable" tar="budget_type" style="display:none;">預算別</a>
        </td>
        <td></td>
    </tr>
    <tr>
        <td width="30" align="center" valign="center">
            <img id="showed_capital_p" class="showed_img" src="/media/project/image/open.png" width="20">
            <img id="hidedn_capital_p" class="hidedn_img" src="/media/project/image/close.png" width="20" style="display:none;">
        </td>
        <td>
            <a id="hide_capital_p" class="hideTable" tar="capital_p">資本門預算</a>
            <a id="show_capital_p" class="showTable" tar="capital_p" style="display:none;">資本門預算</a>
        </td>
        <td></td>
    </tr>
    <!--
    <tr>
        <td width="30" align="center" valign="center">
            <img id="showed_capital_a" class="showed_img" src="/media/project/image/open.png" width="20">
            <img id="hidedn_capital_a" class="hidedn_img" src="/media/project/image/close.png" width="20" style="display:none;">
        </td>
        <td>
            <a id="hide_capital_a" class="hideTable" tar="capital_a">資本門 - 調整後預算</a>
            <a id="show_capital_a" class="showTable" tar="capital_a" style="display:none;">資本門 - 調整後預算</a>
        </td>
        <td></td>
    </tr>
    -->
    <tr>
        <td width="30" align="center" valign="center">
            <img id="showed_regular_p" class="showed_img" src="/media/project/image/open.png" width="20">
            <img id="hidedn_regular_p" class="hidedn_img" src="/media/project/image/close.png" width="20" style="display:none;">
        </td>
        <td>
            <a id="hide_regular_p" class="hideTable" tar="regular_p">經常門預算</a>
            <a id="show_regular_p" class="showTable" tar="regular_p" style="display:none;">經常門預算</a>
        </td>
        <td></td>
    </tr>
    <!--
    <tr>
        <td width="30" align="center" valign="center">
            <img id="showed_regular_a" class="showed_img" src="/media/project/image/open.png" width="20">
            <img id="hidedn_regular_a" class="hidedn_img" src="/media/project/image/close.png" width="20" style="display:none;">
        </td>
        <td>
            <a id="hide_regular_a" class="hideTable" tar="regular_a">經常門 - 調整後預算</a>
            <a id="show_regular_a" class="showTable" tar="regular_a" style="display:none;">經常門 - 調整後預算</a>
        </td>
        <td></td>
    </tr>
    -->
    <!--
    <tr>
        <td width="30" align="center" valign="center">
            <img id="showed_next_year_need" class="showed_img" src="/media/project/image/open.png" width="20">
            <img id="hidedn_next_year_need" class="hidedn_img" src="/media/project/image/close.png" width="20" style="display:none;">
        </td>
        <td>
            <a id="hide_next_year_need" class="hideTable" tar="next_year_need">本署尚需編列預算</a>
            <a id="show_next_year_need" class="showTable" tar="next_year_need" style="display:none;">本署尚需編列預算</a>
        </td>
        <td></td>
    </tr>
    <tr>
        <td width="30" align="center" valign="center">
            <img id="showed_project_memo" class="showed_img" src="/media/project/image/open.png" width="20">
            <img id="hidedn_project_memo" class="hidedn_img" src="/media/project/image/close.png" width="20" style="display:none;">
        </td>
        <td>
            <a id="hide_project_memo" class="hideTable" tar="project_memo">工程備註</a>
            <a id="show_project_memo" class="showTable" tar="project_memo" style="display:none;">工程備註</a>
        </td>
        <td></td>
    </tr>
    -->
    </tbody>
</table>

        <br>
        <div>
        <table id="BugdgetTable" border="1" style="border-collapse: collapse">
            <thead>
                <tr id="showbar" align="center" height="20">
                    <th></th>
                    <th class="showed year intable" align="center"><a id="hide_year" class="hideCol" tar="year">隱藏</a></th>
                    <th class="showed place intable" align="center"><a id="hide_place" class="hideCol" tar="place">隱藏</a></th>
                    <th class="showed port intable" align="center"><a id="hide_port" class="hideCol" tar="port">隱藏</a></th>
                    <th class="showed plan_no intable" align="center"><a id="hide_plan_no" class="hideCol" tar="plan_no">隱藏</a></th>
                    <th></th>
                    <th class="showed project_sub_type intable" align="center"><a id="hide_project_sub_type" class="hideCol" tar="project_sub_type">隱藏</a></th>
                    <th class="showed undertake_type intable" align="center"><a id="hide_undertake_type" class="hideCol" tar="undertake_type">隱藏</a></th>
                    <th class="showed budget_type intable" align="center"><a id="hide_budget_type" class="hideCol" tar="budget_type">隱藏</a></th>
                    <th colspan="2" class="showed capital_p intable" align="center"><a id="hide_capital_p" class="hideCol" tar="capital_p">隱藏</a></th>
<!--                    <th colspan="5" class="showed capital_a intable" align="center"><a id="hide_capital_a" class="hideCol" tar="capital_a">隱藏</a></th>-->
                    <th colspan="2" class="showed regular_p intable" align="center"><a id="hide_regular_p" class="hideCol" tar="regular_p">隱藏</a></th>
<!--                    <th colspan="5" class="showed regular_a intable" align="center"><a id="hide_regular_a" class="hideCol" tar="regular_a">隱藏</a></th>-->
<!--                    <th class="showed next_year_need intable" align="center"><a id="hide_next_year_need" class="hideCol" tar="next_year_need">隱藏</a></th>-->
<!--                    <th class="showed project_memo intable" align="center"><a id="hide_project_memo" class="hideCol" tar="project_memo">隱藏</a></th>-->
                </tr>
                <tr bgcolor='#E1F0F0' align="center" class="showbar">
                    <th rowspan="2" style="min-width:15px;">#</th>
                    <th rowspan="2" class="showed year intable" id="year" style="min-width:40px;">預算<br>年度</th>
                    <th rowspan="2" class="showed place intable" id="place" style="min-width:60px;">縣市</th>
                    <th rowspan="2" class="showed port intable" id="port" style="min-width:60px;">漁港</th>
                    <th rowspan="2" class="showed plan_no intable" id="plan_no" style="min-width:100px;">計畫編號</th>
                    <th rowspan="2" style="min-width:150px;">工作名稱</th>
                    <th rowspan="2" class="showed project_sub_type intable" id="project_sub_type" style="min-width:20px;">工<br>程<br>屬<br>性<br>別</th>
                    <th rowspan="2" class="showed undertake_type intable" id="undertake_type" style="min-width:30px;">承辦<br>方式</th>
                    <th rowspan="2" class="showed budget_type intable" id="budget_type" style="min-width:30px;">預算別</th>
                    <th bgcolor='#F0F078' colspan="2" class="showed capital_p intable" id="capital_p">資本門預算</th>
<!--                    <th bgcolor='#F0F078' colspan="5" class="showed capital_a intable" id="capital_a">資本門 - 調整後預算</th>-->
                    <th bgcolor='#B4E1B4' colspan="2" class="showed regular_p intable" id="regular_p">經常門預算</th>
<!--                    <th bgcolor='#B4E1B4' colspan="5" class="showed regular_a intable" id="regular_a">經常門 - 調整後預算</th>-->
<!--                    <th rowspan="2" class="showed next_year_need intable" id="next_year_need " style="min-width:65px;">本署尚需<br>編列預算</th>-->
<!--                    <th rowspan="2" class="showed project_memo intable" id="project_memo" style="min-width:60px;">工程<br>備註</th>-->
                </tr>
                <tr align="center" class="showbar">
                    <th bgcolor='#F0F078' class="capital_p intable" style="min-width:65px;">核定數</th>
                    <th bgcolor='#F0F078' class="capital_p intable" style="min-width:65px;">修正核定數</th>
<!--                    <th bgcolor='#F0F078' class="capital_a intable" style="min-width:65px;">工程執行經費<br>(發包及其他費用)</th>-->
<!--                    <th bgcolor='#F0F078' class="capital_a intable" style="min-width:65px;">發包<br>剩餘款</th>-->
<!--                    <th bgcolor='#F0F078' class="capital_a intable" style="min-width:65px;">調整後<br>地方配合款</th>-->
<!--                    <th bgcolor='#F0F078' class="capital_a intable" style="min-width:65px;">小計</th>-->
<!--                    <th bgcolor='#F0F078' class="capital_a intable" style="min-width:65px;">備註</th>-->
                    <th bgcolor='#B4E1B4' class="regular_p intable" style="min-width:65px;">核定數</th>
                    <th bgcolor='#B4E1B4' class="regular_p intable" style="min-width:65px;">修正核定數</th>
<!--                    <th bgcolor='#B4E1B4' class="regular_a intable" style="min-width:65px;">工程執行經費<br>(發包及其他費用)</th>-->
<!--                    <th bgcolor='#B4E1B4' class="regular_a intable" style="min-width:65px;">發包<br>剩餘款</th>-->
<!--                    <th bgcolor='#B4E1B4' class="regular_a intable" style="min-width:65px;">調整後<br>地方配合款</th>-->
<!--                    <th bgcolor='#B4E1B4' class="regular_a intable" style="min-width:65px;">小計</th>-->
<!--                    <th bgcolor='#B4E1B4' class="regular_a intable" style="min-width:65px;">備註</th>-->
                </tr>
            </thead>
            <tbody>
                {% for p in projects %}
                    <tr class="{% cycle "odd" "even" %}" id="{{ p.budget_INFO.id }}">
                        <td align="center">{{ forloop.counter }}</td>
                        <td class="year intable" align="center">{{ p.budget_INFO.year }}</td>
                        <td class="place intable">{% if p.place %}{{ p.place.name }}{% endif %}</td>
                        <td class="port intable">{% for fp in p.project_port_set.all %}{{ fp.port.name }}<br>{% endfor %}</td>
                        <td class="plan_no intable">{{ p.plan.no|default_if_none:'' }}</td>
                        <td width="200"><a href="/project/reproject/{{ p.id }}/" target="_blank">{{ p.name }}</a></td>
                        <td class="project_sub_type intable" align="center" title="{{ p.project_sub_type.value }}">{% if p.project_sub_type %}{{ p.project_sub_type.value.0 }}{% endif %}</td>
                        <td class="undertake_type intable" align="center">{% if p.undertake_type %}{{ p.undertake_type.value }}{% endif %}</td>
                        <td class="budget_type intable" align="center" bgcolor="{% ifequal p.budget_type.value '公務預算' %}#C3E1F0{% else %}#E1B4F0{% endifequal %}">{{ p.short_budget_type }}</td>



                        {% if edit %}
                        <td id="capital_ratify_budget" class="redaction" align="right">
                            <a class="show_capital_ratify_budget" align="right">{{ p.fund_set.get.capital_ratify_budget|default_if_none:''|intcomma|cutzero }}</a>
                            <input editing="capital_ratify_budget" category="Fund" row="{{ fund.id }}" class="edit_capital_ratify_budget updateRedaction float" size="4" type="text" value="{% ifequal fund.capital_ratify_budget 0 %}{% else %}{{ fund.capital_ratify_budget|default_if_none:''|cutzero }}{% endifequal %}" old_value="{% ifequal fund.capital_ratify_budget 0 %}{% else %}{{ fund.capital_ratify_budget|default_if_none:''|cutzero }}{% endifequal %}" style="display: none; text-align:right;">
                        </td>
                        {% else %}
                        <td id="capital_ratify_budget" align="right">
                            {{ fund.capital_ratify_budget|default_if_none:''|intcomma|cutzero }}
                        </td>
                        {% endif %}
<!--
                        <td row_id="{{ p.budget_INFO.id }}" field_name="capital_money" align="right" bgcolor='#F0F078' title="資本門_本署預算金額"
                        class="{% cycle "odd2" "even2" %} {% if edit %}edit_by_click{% endif %} capital_p intable">
                            {% if edit %}
                                <a id="show_capital_money_{{ p.budget_INFO.id }}">{% if p.budget_INFO.capital_money %}{{ p.budget_INFO.capital_money|intcomma|cutzero }}{% endif %}</a>
                                <input style="text-align: right;display: none;"
                                       class="edit_by_blur"
                                       input_type="float"
                                       row_id ="{{ p.budget_INFO.id }}"
                                       model_name="BudgetProject"
                                       field_name="capital_money"
                                       type="text"
                                       id="edit_capital_money_{{ p.budget_INFO.id }}"
                                       size="6"
                                       maxlength="32"
                                       old_value ="{{ p.budget_INFO.capital_money }}"
                                       value="{{ p.budget_INFO.capital_money }}"/>
                             {% else %}
                                {% if p.budget_INFO.capital_money %}{{ p.budget_INFO.capital_money|intcomma|cutzero }}{% endif %}
                             {% endif %}
                        </td>

                        <td row_id="{{ p.budget_INFO.id }}" field_name="capital_coordination" align="right" bgcolor='#F0F078' title="資本門_地方配合款"
                        class="{% cycle "odd2" "even2" %} {% if edit %}edit_by_click{% endif %} capital_p intable">
                            {% if edit %}
                                <a id="show_capital_coordination_{{ p.budget_INFO.id }}">{% if p.budget_INFO.capital_coordination %}{{ p.budget_INFO.capital_coordination|intcomma|cutzero }}{% endif %}</a>
                                <input style="text-align: right;display: none;"
                                       class="edit_by_blur"
                                       input_type="float"
                                       row_id ="{{ p.budget_INFO.id }}"
                                       model_name="BudgetProject"
                                       field_name="capital_coordination"
                                       type="text"
                                       id="edit_capital_coordination_{{ p.budget_INFO.id }}"
                                       size="6"
                                       maxlength="32"
                                       old_value ="{{ p.budget_INFO.capital_coordination }}"
                                       value="{{ p.budget_INFO.capital_coordination }}"/>
                            {% else %}
                                {% if p.budget_INFO.capital_coordination %}{{ p.budget_INFO.capital_coordination|intcomma|cutzero }}{% endif %}
                            {% endif %}
                        </td>

                        <td align="right" bgcolor='#F0F078' title="資本門_核定預算小計"
                        class="{% cycle "odd2" "even2" %} capital_p intable">
                            <span id="show_capital_sum_{{ p.budget_INFO.id }}">
                                {% if p.budget_INFO.rCapitalSum %}{{ p.budget_INFO.rCapitalSum|intcomma|cutzero }}{% endif %}
                            </span>
                        </td>
                        
                        <td row_id="{{ p.budget_INFO.id }}" field_name="capital_memo" align="left" bgcolor='#F0F078' title="資本門_核定預算備註"
                        class="{% cycle "odd2" "even2" %} {% if edit %}edit_by_click{% endif %} capital_p intable">
                            {% if edit %}
                                <a id="show_capital_memo_{{ p.budget_INFO.id }}">{% if p.budget_INFO.capital_memo %}{{ p.budget_INFO.capital_memo|linebreaks }}{% endif %}</a>
                                <textarea style="display: none;"
                                       class="edit_by_blur"
                                       row_id ="{{ p.budget_INFO.id }}"
                                       model_name="BudgetProject"
                                       field_name="capital_memo"
                                       type="text"
                                       id="edit_capital_memo_{{ p.budget_INFO.id }}"
                                       cols="20" rows="5"
                                       old_value ="{% if p.budget_INFO.capital_memo %}{{ p.budget_INFO.capital_memo }}{% endif %}">{% if p.budget_INFO.capital_memo %}{{ p.budget_INFO.capital_memo }}{% endif %}</textarea>
                             {% else %}
                                {% if p.budget_INFO.capital_memo %}{{ p.budget_INFO.capital_memo }}{% endif %}
                             {% endif %}
                        </td>

                        <td row_id="{{ p.budget_INFO.id }}" field_name="capital_project_use_money" align="right" bgcolor='#FFFF99' title="資本門_工程執行經費(發包及其他費用)"
                        class="{% cycle "odd2" "even2" %} {% if edit %}edit_by_click{% endif %} capital_a intable">
                            {% if edit %}
                                <a id="show_capital_project_use_money_{{ p.budget_INFO.id }}">{% if p.budget_INFO.capital_project_use_money %}{{ p.budget_INFO.capital_project_use_money|intcomma|cutzero }}{% endif %}</a>
                                <input style="text-align: right;display: none;"
                                       class="edit_by_blur"
                                       input_type="float"
                                       row_id ="{{ p.budget_INFO.id }}"
                                       model_name="BudgetProject"
                                       field_name="capital_project_use_money"
                                       type="text"
                                       id="edit_capital_project_use_money_{{ p.budget_INFO.id }}"
                                       size="6"
                                       maxlength="32"
                                       old_value ="{{ p.budget_INFO.capital_project_use_money }}"
                                       value="{{ p.budget_INFO.capital_project_use_money }}"/>
                             {% else %}
                                {% if p.budget_INFO.capital_project_use_money %}{{ p.budget_INFO.capital_project_use_money|intcomma|cutzero }}{% endif %}
                             {% endif %}
                        </td>

                        <td row_id="{{ p.budget_INFO.id }}" field_name="capital_bid_surplus" align="right" bgcolor='#FFFF99' title="資本門_節餘數"
                        class="{% cycle "odd2" "even2" %} {% if edit %}edit_by_click{% endif %} capital_a intable">
                            {% if edit %}
                                <a id="show_capital_bid_surplus_{{ p.budget_INFO.id }}">{% if p.budget_INFO.capital_bid_surplus %}{{ p.budget_INFO.capital_bid_surplus|intcomma|cutzero }}{% endif %}</a>
                                <input style="text-align: right;display: none;"
                                       class="edit_by_blur"
                                       input_type="float"
                                       row_id ="{{ p.budget_INFO.id }}"
                                       model_name="BudgetProject"
                                       field_name="capital_bid_surplus"
                                       type="text"
                                       id="edit_capital_bid_surplus_{{ p.budget_INFO.id }}"
                                       size="6"
                                       maxlength="32"
                                       old_value ="{{ p.budget_INFO.capital_bid_surplus }}"
                                       value="{{ p.budget_INFO.capital_bid_surplus }}"/>
                             {% else %}
                                {% if p.budget_INFO.capital_bid_surplus %}{{ p.budget_INFO.capital_bid_surplus|intcomma|cutzero }}{% endif %}
                             {% endif %}
                        </td>

                        <td row_id="{{ p.budget_INFO.id }}" field_name="capital_co_adj" align="right" bgcolor='#FFFF99' title="資本門_調整後地方配合款"
                        class="{% cycle "odd2" "even2" %} {% if edit %}edit_by_click{% endif %} capital_a intable">
                            {% if edit %}
                                <a id="show_capital_co_adj_{{ p.budget_INFO.id }}">{% if p.budget_INFO.capital_co_adj %}{{ p.budget_INFO.capital_co_adj|intcomma|cutzero }}{% endif %}</a>
                                <input style="text-align: right;display: none;"
                                       class="edit_by_blur"
                                       input_type="float"
                                       row_id ="{{ p.budget_INFO.id }}"
                                       model_name="BudgetProject"
                                       field_name="capital_co_adj"
                                       type="text"
                                       id="edit_capital_co_adj_{{ p.budget_INFO.id }}"
                                       size="6"
                                       maxlength="32"
                                       old_value ="{{ p.budget_INFO.capital_co_adj }}"
                                       value="{{ p.budget_INFO.capital_co_adj }}"/>
                             {% else %}
                                {% if p.budget_INFO.capital_co_adj %}{{ p.budget_INFO.capital_co_adj|intcomma|cutzero }}{% endif %}
                             {% endif %}
                        </td>

                        <td align="right" bgcolor='#F0F078' title="資本門_調整後預算小計"
                        class="{% cycle "odd2" "even2" %} capital_a intable">
                            <span id="show_capital_adjust_sum_{{ p.budget_INFO.id }}">
                                {% if p.budget_INFO.rCapitalAdjustSum %}{{ p.budget_INFO.rCapitalAdjustSum|intcomma|cutzero }}{% endif %}
                            </span>
                        </td>

                        <td row_id="{{ p.budget_INFO.id }}" field_name="capital_adjust_memo" align="left" bgcolor='#F0F078' title="資本門_調整後預算備註"
                        class="{% cycle "odd2" "even2" %} {% if edit %}edit_by_click{% endif %} capital_a intable">
                            {% if edit %}
                                <a id="show_capital_adjust_memo_{{ p.budget_INFO.id }}">{% if p.budget_INFO.capital_adjust_memo %}{{ p.budget_INFO.capital_adjust_memo|linebreaks }}{% endif %}</a>
                                <textarea style="display: none;"
                                       class="edit_by_blur"
                                       row_id ="{{ p.budget_INFO.id }}"
                                       model_name="BudgetProject"
                                       field_name="capital_adjust_memo"
                                       type="text"
                                       id="edit_capital_adjust_memo_{{ p.budget_INFO.id }}"
                                       cols="20" rows="5"
                                       old_value ="{% if p.budget_INFO.capital_adjust_memo %}{{ p.budget_INFO.capital_adjust_memo }}{% endif %}">{% if p.budget_INFO.capital_adjust_memo %}{{ p.budget_INFO.capital_adjust_memo }}{% endif %}</textarea>
                             {% else %}
                                {% if p.budget_INFO.capital_adjust_memo %}{{ p.budget_INFO.capital_adjust_memo }}{% endif %}
                             {% endif %}
                        </td>

                        <td row_id="{{ p.budget_INFO.id }}" field_name="regular_money" align="right" bgcolor='#B4E1B4' title="經常門_本署預算金額"
                        class="{% cycle "odd3" "even3" %} {% if edit %}edit_by_click{% endif %} regular_p intable">
                            {% if edit %}
                                <a id="show_regular_money_{{ p.budget_INFO.id }}">{% if p.budget_INFO.regular_money %}{{ p.budget_INFO.regular_money|intcomma|cutzero }}{% endif %}</a>
                                <input style="text-align: right;display: none;"
                                       class="edit_by_blur"
                                       input_type="float"
                                       row_id ="{{ p.budget_INFO.id }}"
                                       model_name="BudgetProject"
                                       field_name="regular_money"
                                       type="text"
                                       id="edit_regular_money_{{ p.budget_INFO.id }}"
                                       size="6"
                                       maxlength="32"
                                       old_value ="{{ p.budget_INFO.regular_money }}"
                                       value="{{ p.budget_INFO.regular_money }}"/>
                             {% else %}
                                {% if p.budget_INFO.regular_money %}{{ p.budget_INFO.regular_money|intcomma|cutzero }}{% endif %}
                             {% endif %}
                        </td>

                        <td row_id="{{ p.budget_INFO.id }}" field_name="regular_coordination" align="right" bgcolor='#B4E1B4' title="經常門_地方配合款"
                        class="{% cycle "odd3" "even3" %} {% if edit %}edit_by_click{% endif %} regular_p intable">
                            {% if edit %}
                                <a id="show_regular_coordination_{{ p.budget_INFO.id }}">{% if p.budget_INFO.regular_coordination %}{{ p.budget_INFO.regular_coordination|intcomma|cutzero }}{% endif %}</a>
                                <input style="text-align: right;display: none;"
                                       class="edit_by_blur"
                                       input_type="float"
                                       row_id ="{{ p.budget_INFO.id }}"
                                       model_name="BudgetProject"
                                       field_name="regular_coordination"
                                       type="text"
                                       id="edit_regular_coordination_{{ p.budget_INFO.id }}"
                                       size="6"
                                       maxlength="32"
                                       old_value ="{{ p.budget_INFO.regular_coordination }}"
                                       value="{{ p.budget_INFO.regular_coordination }}"/>
                            {% else %}
                                {% if p.budget_INFO.regular_coordination %}{{ p.budget_INFO.regular_coordination|intcomma|cutzero }}{% endif %}
                            {% endif %}
                        </td>

                        <td align="right" bgcolor='#B4E1B4' title="經常門_核定預算小計"
                        class="{% cycle "odd3" "even3" %} regular_p intable">
                            <span id="show_regular_sum_{{ p.budget_INFO.id }}">
                                {% if p.budget_INFO.rRegularSum%}{{ p.budget_INFO.rRegularSum|intcomma|cutzero }}{% endif %}
                            </span>
                        </td>

                        <td row_id="{{ p.budget_INFO.id }}" field_name="regular_memo" align="left" bgcolor='#B4E1B4' title="經常門_核定預算備註"
                        class="{% cycle "odd3" "even3" %} {% if edit %}edit_by_click{% endif %} regular_p intable">
                            {% if edit %}
                                <a id="show_regular_memo_{{ p.budget_INFO.id }}">{% if p.budget_INFO.regular_memo %}{{ p.budget_INFO.regular_memo|linebreaks }}{% endif %}</a>
                                <textarea style="display: none;"
                                       class="edit_by_blur"
                                       row_id ="{{ p.budget_INFO.id }}"
                                       model_name="BudgetProject"
                                       field_name="regular_memo"
                                       type="text"
                                       id="edit_regular_memo_{{ p.budget_INFO.id }}"
                                       cols="20" rows="5"
                                       old_value ="{% if p.budget_INFO.regular_memo %}{{ p.budget_INFO.regular_memo }}{% endif %}">{% if p.budget_INFO.regular_memo %}{{ p.budget_INFO.regular_memo }}{% endif %}</textarea>
                             {% else %}
                                {% if p.budget_INFO.regular_memo %}{{ p.budget_INFO.regular_memo }}{% endif %}
                             {% endif %}
                        </td>

                        <td row_id="{{ p.budget_INFO.id }}" field_name="regular_project_use_money" align="right" bgcolor='#B4E1B4' title="經常門_工程執行經費(發包及其他費用)"
                        class="{% cycle "odd3" "even3" %} {% if edit %}edit_by_click{% endif %} regular_a intable">
                            {% if edit %}
                                <a id="show_regular_project_use_money_{{ p.budget_INFO.id }}">{% if p.budget_INFO.regular_project_use_money %}{{ p.budget_INFO.regular_project_use_money|intcomma|cutzero }}{% endif %}</a>
                                <input style="text-align: right;display: none;"
                                       class="edit_by_blur"
                                       input_type="float"
                                       row_id ="{{ p.budget_INFO.id }}"
                                       model_name="BudgetProject"
                                       field_name="regular_project_use_money"
                                       type="text"
                                       id="edit_regular_project_use_money_{{ p.budget_INFO.id }}"
                                       size="6"
                                       maxlength="32"
                                       old_value ="{{ p.budget_INFO.regular_project_use_money }}"
                                       value="{{ p.budget_INFO.regular_project_use_money }}"/>
                             {% else %}
                                {% if p.budget_INFO.regular_project_use_money %}{{ p.budget_INFO.regular_project_use_money|intcomma|cutzero }}{% endif %}
                             {% endif %}
                        </td>
                        <td row_id="{{ p.budget_INFO.id }}" field_name="regular_bid_surplus" align="right" bgcolor='#B4E1B4' title="經常門_節餘數"
                        class="{% cycle "odd3" "even3" %} {% if edit %}edit_by_click{% endif %} regular_a intable">
                            {% if edit %}
                                <a id="show_regular_bid_surplus_{{ p.budget_INFO.id }}">{% if p.budget_INFO.regular_bid_surplus %}{{ p.budget_INFO.regular_bid_surplus|intcomma|cutzero }}{% endif %}</a>
                                <input style="text-align: right;display: none;"
                                       class="edit_by_blur"
                                       input_type="float"
                                       row_id ="{{ p.budget_INFO.id }}"
                                       model_name="BudgetProject"
                                       field_name="regular_bid_surplus"
                                       type="text"
                                       id="edit_regular_bid_surplus_{{ p.budget_INFO.id }}"
                                       size="6"
                                       maxlength="32"
                                       old_value ="{{ p.budget_INFO.regular_bid_surplus }}"
                                       value="{{ p.budget_INFO.regular_bid_surplus }}"/>
                             {% else %}
                                {% if p.budget_INFO.regular_bid_surplus %}{{ p.budget_INFO.regular_bid_surplus|intcomma|cutzero }}{% endif %}
                             {% endif %}
                        </td>

                        <td row_id="{{ p.budget_INFO.id }}" field_name="regular_co_adj" align="right" bgcolor='#B4E1B4' title="經常門_調整後地方配合款"
                        class="{% cycle "odd3" "even3" %} {% if edit %}edit_by_click{% endif %} regular_a intable">
                            {% if edit %}
                                <a id="show_regular_co_adj_{{ p.budget_INFO.id }}">{% if p.budget_INFO.regular_co_adj %}{{ p.budget_INFO.regular_co_adj|intcomma|cutzero }}{% endif %}</a>
                                <input style="text-align: right;display: none;"
                                       class="edit_by_blur"
                                       input_type="float"
                                       row_id ="{{ p.budget_INFO.id }}"
                                       model_name="BudgetProject"
                                       field_name="regular_co_adj"
                                       type="text"
                                       id="edit_regular_co_adj_{{ p.budget_INFO.id }}"
                                       size="6"
                                       maxlength="32"
                                       old_value ="{{ p.budget_INFO.regular_co_adj }}"
                                       value="{{ p.budget_INFO.regular_co_adj }}"/>
                             {% else %}
                                {% if p.budget_INFO.regular_co_adj %}{{ p.budget_INFO.regular_co_adj|intcomma|cutzero }}{% endif %}
                             {% endif %}
                        </td>

                        <td align="right" bgcolor='#B4E1B4' title="經常門_調整後預算小計"
                        class="{% cycle "odd3" "even3" %} regular_a intable">
                            <span id="show_regular_adjust_sum_{{ p.budget_INFO.id }}">
                                {% if p.budget_INFO.rRegularAdjustSum%}{{ p.budget_INFO.rRegularAdjustSum|intcomma|cutzero }}{% endif %}
                            </span>
                        </td>

                        <td row_id="{{ p.budget_INFO.id }}" field_name="regular_adjust_memo" align="left" bgcolor='#B4E1B4' title="經常門_調整後預算備註"
                        class="{% cycle "odd3" "even3" %} {% if edit %}edit_by_click{% endif %} regular_a intable">
                            {% if edit %}
                                <a id="show_regular_adjust_memo_{{ p.budget_INFO.id }}">{% if p.budget_INFO.regular_adjust_memo %}{{ p.budget_INFO.regular_adjust_memo|linebreaks }}{% endif %}</a>
                                <textarea style="display: none;"
                                       class="edit_by_blur"
                                       row_id ="{{ p.budget_INFO.id }}"
                                       model_name="BudgetProject"
                                       field_name="regular_adjust_memo"
                                       type="text"
                                       id="edit_regular_adjust_memo_{{ p.budget_INFO.id }}"
                                       cols="20" rows="5"
                                       old_value ="{% if p.budget_INFO.regular_adjust_memo %}{{ p.budget_INFO.regular_adjust_memo }}{% endif %}">{% if p.budget_INFO.regular_adjust_memo %}{{ p.budget_INFO.regular_adjust_memo }}{% endif %}</textarea>
                             {% else %}
                                {% if p.budget_INFO.regular_adjust_memo %}{{ p.budget_INFO.regular_adjust_memo }}{% endif %}
                             {% endif %}
                        </td>

                        <td row_id="{{ p.budget_INFO.id }}" field_name="next_year_need" align="right" title="本署尚需編列預算"
                        class="{% if edit %}edit_by_click{% endif %} next_year_need intable">
                            {% if edit %}
                                <a id="show_next_year_need_{{ p.budget_INFO.id }}">{% if p.budget_INFO.next_year_need %}{{ p.budget_INFO.next_year_need|intcomma|cutzero }}{% endif %}</a>
                                <input style="text-align: right;display: none;"
                                       class="edit_by_blur"
                                       input_type="float"
                                       row_id ="{{ p.budget_INFO.id }}"
                                       model_name="BudgetProject"
                                       field_name="next_year_need"
                                       type="text"
                                       id="edit_next_year_need_{{ p.budget_INFO.id }}"
                                       size="6"
                                       maxlength="32"
                                       old_value ="{{ p.budget_INFO.next_year_need }}"
                                       value="{{ p.budget_INFO.next_year_need }}"/>
                             {% else %}
                                {% if p.budget_INFO.next_year_need %}{{ p.budget_INFO.next_year_need|intcomma|cutzero }}{% endif %}
                             {% endif %}
                        </td>
                        <td class="project_memo intable"><a class="showProjectMemo" mark="{{ p.name }}" memo="{{ p.project_memo|linebreaks }}">{{ p.short_memo }}</a></td>-->
                    </tr>
                {% endfor %}
            </tbody>
        </table>
        </div>
        <br>

        <div align="right" style="margin-right: 200px">共 {{ projects_num }} 個結果</div>
    {% endif %}
    </div>

</span>



{% endblock %}