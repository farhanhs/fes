{% load i18n %}
{% load humanize %}{% load dailyreport_tags %}
<!DOCTYPE html PUBLIC>
<html lang="zh-tw">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <script type="text/javascript" src="/media/dailyreport/jquery/smoothness/jquery-ui-1.10.3.custom.css{{ settings.SV_ }}"></script>
    <script type="text/javascript" src="/media/dailyreport/jquery/jquery-1.10.2.js{{ settings.SV_ }}"></script>
    <script type="text/javascript" src="/media/dailyreport/jquery/jquery-ui-1.10.3.custom.js{{ settings.SV_ }}" ></script>
    <link rel="stylesheet" type="text/css" href="/media/dailyreport/jquery/smoothness/jquery-ui-1.10.3.custom.css{{ settings.SV_ }}" charset="utf-8"/>
    
    <script type="text/javascript">
        var DEBUG = {% if settings.DEBUG %}true{% else %}false{% endif %};
        var CSRFMIDDLEWARETOKEN;
        var SUB_PAGE_LIST = '';
    </script>

    <link rel="stylesheet" type="text/css" href="/media/dailyreport/css/print_style.css{{ settings.SV_ }}" charset="utf-8"/>
    <link rel="stylesheet" type="text/css" href="/media/dailyreport/bootstrap/css/bootstrap.css{{ settings.SV_ }}"/>
    <link rel="stylesheet" type="text/css" href="/media/dailyreport/bootstrap/css/bootstrap-responsive.css{{ settings.SV_ }}"/>

    <script type="text/javascript" src="/media/dailyreport/js/dailyreport.js{{ settings.SV_ }}"></script>
    <script type="text/javascript" src="/media/dailyreport/js/purl.js{{ settings.SV_ }}"></script>
    <script type="text/javascript" src="/media/dailyreport/js/jquery.contextmenu.r2.js{{ settings.SV_ }}" ></script>
    <script type="text/javascript" src="/media/dailyreport/jstree/jquery.hotkeys.js{{ settings.SV_ }}"></script>
    <script type="text/javascript" src="/media/dailyreport/jstree/jquery.cookie.js{{ settings.SV_ }}"></script>
    <script type="text/javascript" src="/media/dailyreport/sorttable/sorttable.js{{ settings.SV_ }}"></script>
    <script type="text/javascript" src="/media/dailyreport/bootstrap/js/bootstrap.js{{ settings.SV_ }}"></script>
    {% block js_in_compress %}{% endblock %}

    {% block script %}{% endblock %}

    <title>{% block title %}線上日報表系統{% endblock %}</title>
</head>
<body style="text-align: center;font-family: 'Helvetica Neue', Helvetica, '微軟正黑體', 'Microsoft Jhenghei', Arial, sans-serif;">
    <img id="loading" src="/media/dailyreport/images/loading.gif" width="50" style="display:none;" />

    
    {% csrf_token %}

    <input type="button" name="print" class="btn btn-large btn-success" id="print_button" onClick="window.print(); return false" value="列印此頁"> </input>
    <a href="#chrome_print_settings" id="chrome_print_settings_button" role="button" class="btn btn-inverse" data-toggle="modal"><img src="/media/dailyreport/print_settings/chrome.png" width="25"> Chrome列印設定</a>
    <a href="#firefox_print_settings" id="firefox_print_settings_button" role="button" class="btn btn-inverse" data-toggle="modal"><img src="/media/dailyreport/print_settings/firefox.png" width="25"> FireFox列印設定</a>
    <a href="#ie_print_settings" id="ie_print_settings_button" role="button" class="btn btn-inverse" data-toggle="modal"><img src="/media/dailyreport/print_settings/ie.png" width="25"> IE列印設定</a>

    {% include 'dailyreport/zh-tw/explanation.html' %}

    {% for report in reports %}
    <div class="page">
        <table width="100%">
            <tr>
                <td colspan="2">公共工程監造報表</td>
            </tr>
            <tr>
                <td colsapn="2" class="td_left">報表編號：</td>
            </tr>
            <tr>
                <td width="50%" class="td_left">本日天氣：上午：{{ report.morning_weather.value }}　下午：{{ report.afternoon_weather.value }}</td>
                <td width="50%" class="td_right">填報日期：{{ report.date|dateformat }}({{ report.weekday }})</td>
            </tr>
        </table>

        <table style="border-collapse: collapse" border="1" width="100%">
            <tr>
                <td width="12.5%">工程名稱</td>
                <td width="87.5%" colspan="9" class="td_left">{{ engprofile.project.name }}</td>
            </tr>
            <tr>
                <td width="12.5%">契約工期</td>
                <td width="12.5%">
                    {% ifequal engprofile.date_type.value '限期完工(日曆天每日施工)' %}
                        {{ engprofile.deadline|dateformat }}
                    {% else %}
                        {{ engprofile.duration }} 天<br>({{ engprofile.date_type.value }})
                    {% endifequal %}
                </td>
                <td width="12.5%">開工日期</td>
                <td width="12.5%" colspan="2">{{ engprofile.start_date|dateformat }}</td>
                <td width="12.5%" colspan="2" style="font-size:12px;">預定完工日期</td>
                <td width="12.5%">{{ report.scheduled_completion_day|dateformat }}</td>
                <td width="12.5%" style="font-size:12px;">實際完工日期</td>
                <td width="12.5%"></td>
            </tr>
            <tr>
                <td style="font-size:12px;">契約變更次數</td>
                <td>
                    {{ report.change_version_times }} 次
                </td>
                <td style="font-size:12px;">工期展延天數</td>
                <td colspan="2" class="td_right">{{ report.extensions }} 天</td>
                <td colspan="2" rowspan="2">契約金額</td>
                <td>原契約：</td>
                <td colspan="2" class="td_right">{{ engprofile.readFirstVersion.engs_price|floatformat:3|intcomma|cutzero }} 元</td>
            </tr>
            <tr>
                <td>預定進度(%)</td>
                <td>
                    {{ report.design_percent }} %
                </td>
                <td>實際進度(%)</td>
                <td colspan="2">{{ report.sum_progress_rate }} %</td>
                <td style="font-size:12px;">變更後契約：</td>
                <td colspan="2" class="td_right">{{ report.change_engs_price|floatformat:3|intcomma|cutzero }} 元</td>
            </tr>
            <tr>
                <td colspan="10" class="td_left"><b>一、工程進行情況(含約定之重要施工項目及數量)：</b></td>
            </tr> 
            <tr>
                <td width="43.75%" colspan="4">施工項目</td>
                <td width="6.25%">單位</td>
                <td colspan="2">契約數量</td>
                <td style="font-size:12px;">本日完成數量</td>
                <td style="font-size:12px;">累計完成數量</td>
                <td>備註</td>
            </tr>
            {% for item in report.items %}
                {% ifnotequal item.kind.value '目錄' %}
                    <tr>
                        <td colspan="4" class="td_left">{{ item.name }}</td>
                        <td>{{ item.unit_name }}</td>
                        <td colspan="2" class="td_right">{{ item.unit_num|cutzero }}</td>
                        <td class="td_right">{{ item.num|cutzero }}</td>
                        <td class="td_right">{{ item.sum_num|cutzero }}</td>
                        <td class="td_left" style="font-size: 10px;">{{ item.note|default_if_none:"" }}</td>
                    </tr>
                {% else %}
                    <tr>
                        <td colspan="4" class="td_left">{{ item.name }}</td>
                        <td colspan="6" class="td_right"></td>
                    </tr>
                {% endifnotequal %}
            {% endfor %}
            <tr>
                <td colspan="4" class="td_left"></td>
                <td></td>
                <td colspan="2" class="td_right"></td>
                <td class="td_right"></td>
                <td class="td_right"></td>
                <td class="td_left"></td>
            </tr>
            <tr>
                <td colspan="4" class="td_left"></td>
                <td></td>
                <td colspan="2" class="td_right"></td>
                <td class="td_right"></td>
                <td class="td_right"></td>
                <td class="td_left"></td>
            </tr>
            <tr>
                <td colspan="10" height="40" class="td_left" style="font-size: 12px">
                    {{ report.i_project_status|default_if_none:""|linebreaks }}
                </td>
            </tr> 
            <tr>
                <td colspan="10" class="td_left">
                    <b>
                        {% if report.over_20190501 %}
                            二、監督依照設計圖說及核定施工圖說施工（含約定之檢驗停留點及施工抽查等情形）：
                        {% else %}
                            二、監督依照設計圖說施工(含約定之檢驗停留點及施工抽查等情形)：
                        {% endif %}
                    </b>
                </td>
            </tr> 
            <tr>
                <td colspan="10" height="40" class="td_left" style="font-size: 12px">
                    {{ report.note|default_if_none:""|linebreaks }}
                </td>
            </tr> 
            <tr>
                <td colspan="10" class="td_left"><b>三、查核材料規格及品質(含約定之檢驗停留點、材料設備管制及檢（試）驗等抽驗情形)：</b></td>
            </tr> 
            <tr>
                <td colspan="10" height="40" class="td_left" style="font-size: 12px">
                    {% if report.test_records %}
                        <table>
                            {% for test in report.test_records %}
                            <tr>
                                <td>{{ test.testtype.type_name }}：</td>
                                <td>{{ test.record_name }}</td>
                                <td>({{ test.type }})</td>
                                <td> - {% if test.qualified %}合格{% else %}不合格{% endif %} - </td>
                                <td>{{ test.record_memo }}</td>
                            </tr>
                            {% endfor %}
                        </table>
                    -------------------------------------------------------------------------------------------------------------------<br>
                    {% endif %}
                    {{ report.sampling|default_if_none:""|linebreaks }}
                </td>
            </tr> 
            <tr>
                <td colspan="10" class="td_left"><b>四、督導工地職業安全衛生事項：</b></td>
            </tr> 
            <tr>
                <td colspan="10" height="40" class="td_left" style="font-size: 12px">
                    (一)施工廠商施工前檢查事項辦理情形：{% if report.pre_check %}有{% else %}無{% endif %} 
                    <div style="margin-left: 20px;">
                        {{ report.i_pre_check|default_if_none:""|linebreaks }}
                    </div>
                    (二)其他工地安全衛生督導事項：
                    <div style="margin-left: 20px;">
                        {{ report.describe_subcontractor|default_if_none:""|linebreaks }}
                    </div>
                </td>
            </tr> 
            <tr>
                <td colspan="10" class="td_left"><b>五、其他約定監造事項(含重要事項紀錄、主辦機關指示及通知廠商辦理事項等)：</b></td>
            </tr> 
            <tr>
                <td colspan="10" height="40" class="td_left" style="font-size: 12px">
                    {{ report.notify|default_if_none:""|linebreaks }}
                </td>
            </tr>
            <tr>
                <td colspan="10" class="td_left" height="40"><b>監造單位簽章：</b></td>
            </tr> 
        </table>
    </div>
    {% endfor %}

</body>